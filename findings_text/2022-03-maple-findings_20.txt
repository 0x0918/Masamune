# Gas Optimizations  ### An array's length should be cached to save gas in for-loops  Reading array length at each iteration of the loop takes 6 gas (3 for mload and 3 to place memory_offset) in the stack.  Caching the array length in the stack saves around 3 gas per iteration.  #### Findings  [MapleLoanInternals.sol#L258](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L258)  #### Recommended mitigation steps  ```solidity uint length = calls_.length;  for (uint256 i; i < length; ++i) {     ( bool success, ) = refinancer_.delegatecall(calls_[i]);     require(success, "MLI:ANT:FAILED"); } ```  ---  ### Use `unchecked {}` primitive within for loops  Given the use of Solidity compiler >= 0.8.0, there are default arithmetic checks for mathematical operations which consume additional gas for such checks internally. In expressions where we are absolutely sure of no overflows/underflows, one can use the `unchecked` primitive to wrap such expressions to avoid checks and save gas.  #### Findings  [MapleLoanInternals.sol#L258](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L258)  #### Recommended mitigation steps  Change to  ```solidity for (uint256 i; i < calls_.length;) {     ( bool success, ) = refinancer_.delegatecall(calls_[i]);     require(success, "MLI:ANT:FAILED");      unchecked { ++i; } } ```  ---  ### Use assignment `=` instead of `+=`  Named return variable `lateInterest_` is unused before line [MapleLoanInternals.sol#L589](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L589), therefore it's not necessary to use `+=`.  #### Findings  [MapleLoanInternals.sol#L589](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L589)  #### Recommended mitigation steps  Change to assignment (`=`) to save gas.  ```solidity lateInterest_ = _getInterest(principal_, interestRate_ + lateInterestPremium_, fullDaysLate); lateInterest_ += (lateFeeRate_ * principal_) / SCALED_ONE; ```  ---  ### Unused named returns can be removed  #### Description  Removing unused named return variables can reduce gas usage and improve code clarity.  #### Recommended mitigation steps  Remove the unused named return variables or use them instead of creating additional variables.  #### Findings  **[RevenueDistributionToken.sol](https://github.com/maple-labs/revenue-distribution-token/blob/v1.0.0-beta.1/contracts/RevenueDistributionToken.sol)**  [#L193](https://github.com/maple-labs/revenue-distribution-token/blob/v1.0.0-beta.1/contracts/RevenueDistributionToken.sol#L193) unnecessary named return `apr_`  [#L196](https://github.com/maple-labs/revenue-distribution-token/blob/v1.0.0-beta.1/contracts/RevenueDistributionToken.sol#L196) unnecessary named return `balanceOfAssets_`  [#L258](https://github.com/maple-labs/revenue-distribution-token/blob/v1.0.0-beta.1/contracts/RevenueDistributionToken.sol#L258) unnecessary named return `totalManagedAssets_`  [#L284](https://github.com/maple-labs/revenue-distribution-token/blob/v1.0.0-beta.1/contracts/RevenueDistributionToken.sol#L284) unnecessary named return `result_`  **[MapleLoan.sol](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoan.sol)**  [#L244](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoan.sol#L244) unnecessary named return `collateral_`  [#L274-400](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoan.sol#L274-L400)  **[MapleLoanInternals.sol](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol)**  [#L204](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L204) unnecessary named return `proposedRefinanceCommitment_`  [#L397](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L397) unnecessary named return `isMaintained_`  [#L434](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L434) unnecessary named return `unaccountedAmount_`  [#L442](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L422) unnecessary named return `mapleGlobals_`  [#L456](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L456) unnecessary named return `collateral_`  [#L495](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L495) unnecessary named return `interest_`  [#L594](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L594) unnecessary named return `periodicInterestRate_`  [#L599](https://github.com/maple-labs/loan/blob/v3.0.0-beta.1/contracts/MapleLoanInternals.sol#L599) unnecessary named return `refinanceCommitment_` 
