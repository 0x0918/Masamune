# Handle  cmichel   # Vulnerability details  The `ConstantProductPool.getAmountOut` function does not verify that `tokenIn == token1` in the `else` branch. This is done everywhere else though (see `swap` and `flashSwap`) and should be done here as well.  ## Impact The function can be called with a token that is not any of the pool tokens.  ## Recommended Mitigation Steps Add the missing check.  
